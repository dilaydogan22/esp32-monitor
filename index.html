<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32 Mesafe Monitor</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        body {
            font-family: 'Courier New', monospace;
            text-align: center;
            background-color: #f5f5dc; /* Bej */
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 450px;
            margin: 50px auto;
            background: #fff;
            padding: 20px;
            border: 5px solid #ff69b4; /* Pembe */
            box-shadow: 5px 5px 0px #ffb7b2;
        }
        h2 {
            border-bottom: 2px dashed #ff69b4;
            padding-bottom: 10px;
        }
        .value {
            font-size: 60px;
            font-weight: bold;
            margin: 20px 0;
            display: block;
        }
        .status-box {
            padding: 15px;
            margin-top: 20px;
            border: 1px solid #333;
            font-weight: bold;
        }
        .danger {
            color: #d8000c;
            background-color: #ffd2d2;
        }
        .safe {
            color: #4f8a10;
            background-color: #dff2bf;
        }
        .footer {
            margin-top: 20px;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>MESAFE MONITORU</h2>
    
    <div id="displayValue" class="value">-- cm</div>
    <div id="statusBox" class="status-box">[ ? ] BEKLENIYOR...</div>

    <div class="footer">
        Veri canli olarak Firebase'den cekiliyor.<br>
        Guncelleme: <span id="lastUpdate">--</span>
    </div>
</div>

<script>
    // --- BURAYI KENDI BILGILERINLE DOLDUR ---
    const firebaseConfig = {
        apiKey:AIzaSyBa1JYDzUTa5Hi0pg-SSTDXiDW83o49ZcA",
        authDomain: "esp-32-distance.firebaseapp.com",
        databaseURL: "esp-32-distance-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "esp-32-distance",
        storageBucket: "esp-32-distance.firebasestorage.app",
        messagingSenderId: "1025261979304",
        appId: "1:1025261979304:web:a36b7d8a66c5a23742649d"
    };

    // Firebase'i başlat
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Veriyi Dinle (/sensor/distance yolu)
    const distanceRef = db.ref('/sensor/distance');

    distanceRef.on('value', (snapshot) => {
        const data = snapshot.val();
        const displayDiv = document.getElementById('displayValue');
        const statusDiv = document.getElementById('statusBox');
        const updateSpan = document.getElementById('lastUpdate');

        if (data !== null) {
            displayDiv.innerText = data + " cm";

            // Durum Kontrolü
            if (data > 0 && data < 10) {
                statusDiv.className = "status-box danger";
                statusDiv.innerText = "[ ! ] ENGEL VAR (Role ACIK)";
            } else {
                statusDiv.className = "status-box safe";
                statusDiv.innerText = "[ OK ] GUVENLI (Role KAPALI)";
            }
            
            // Saat güncelleme
            const now = new Date();
            updateSpan.innerText = now.toLocaleTimeString();
        }
    });
</script>

</body>
</html>

